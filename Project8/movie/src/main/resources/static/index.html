<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Genres</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script
            src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>
</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">Movie Genre API</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav" role="tablist">
                <li class="active" role="presentation"><a href="#getAll" ara-controls="getAll" role="tab" data-toggle="tab" id="listAllNav">List All</a></li>
                <li role="presentation"><a href="#get1" role="tab" ara-controls="get1" data-toggle="tab">Get 1</a></li>
                <li role="presentation"><a href="#add" role="tab" ara-controls="add" data-toggle="tab">Add</a></li>
                <li role="presentation"><a href="#update" role="tab" ara-controls="update" data-toggle="tab" id="updateNav">Update</a></li>
                <li role="presentation"><a href="#Delete" role="tab" ara-controls="Delete" data-toggle="tab" id="deleteNav">Delete</a></li>
                <li role="presentation"><a href="#swagger" role="tab" ara-controls="swagger" data-toggle="tab" id="swaggerNav">Swagger UI</a></li>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</nav>
<div style="margin: 35px 0;">&nbsp;</div>
    <div class="container">
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade in active" id="getAll">
                <div class="row">
                    <div class="col-sm-offset-3 col-sm-6">
                        <h2 style="text-align:center">Get All Genres</h2>
                        <span id="stuff"></span>
                    </div>
                </div>
            </div><!--end getall-->

            <div role="tabpanel" class="tab-pane fade" id="get1">
                <div class="row">
                    <div class="col-sm-offset-3 col-sm-6">
                        <h3 style="text-align:center">Search for a specific genre by name.</h3>
                        <span id="DisplayGenre"></span>
                        <div class="form-group">
                            <input type="text" name="search" id="search" placeholder="Search Genres" class="form-control"/>
                        </div>
                        <button type="button" id="getByIdSubmit" class="btn btn-primary">Search</button>
                    </div>
                </div>
            </div><!--end get1-->

            <div role="tabpanel" class="tab-pane fade" id="add">
                <div class="row">
                    <div class="col-sm-offset-3 col-sm-6">
                        <h3 style="text-align:center">Add a new Genre</h3>
                        <form id="theGenre">
                            <div class="form-group">
                                <input id="genreName" type="text" placeholder="Genre Name" name="genreName" class="form-control"/>
                            </div>
                            <div class="form-group">
                                <input name="rating" id="rating" placeholder="rating" class="form-control"/>
                            </div>
                            <button id="addGenre" type="button" class="btn btn-primary">Add Genre</button>
                        </form>
                    </div>
                </div>
            </div><!--end add-->

            <div role="tabpanel" class="tab-pane fade" id="update">
                <div class="row">
                    <div class="col-sm-offset-3 col-sm-6">
                        <h3 style="text-align:center">Update a Genre</h3>
                        <form id="updateGenre">
                            <div class="form-group" id="updateSelect">

                            </div>
                            <div class="form-group">
                                <input type="text" name="genreName" placeholder="Genre Name" id="updateGenreName" class="form-control">
                            </div>
                            <div class="form-group">
                                <input type="text" name="rating" id="updateRating" placeholder="rating" class="form-control">
                            </div>
                            <div>
                                <button type="button" id="updateGenreButton" class="btn btn-primary">Update Genre</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div><!--end update-->

            <div role="tabpanel" class="tab-pane fade" id="Delete">
                <div class="row">
                    <div class="col-sm-offset-3 col-sm-6">
                        <h3 style="text-align:center">Delete a Genre</h3>
                        <form id="dTeam">
                            <div class="form-group" id="deleteSelect">

                            </div>
                            <button type="button" id="deleteTeam" class="btn btn-primary">Delete Team</button>
                        </form>
                        <span id="deleteResult"></span>
                    </div>
                </div>
            </div>

            <div role="tabpanel" class="tab-pane fade" id="swagger">
                <iframe src="/swagger-ui.html" width="100%" height="1900px"></iframe>
            </div>

        </div><!--end tab content-->

</div><!--end .container -->

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
        integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script type="text/javascript">
    //-------------- get all Ajax --------------------------------------------
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            var myObj = JSON.parse(this.responseText);
            var content = "<table class=\"table table-striped\">";
            for (var property in myObj) {
                if (myObj.hasOwnProperty(property)) {
                    content += "<tr><td>" + myObj[property].genreName + "</td><td>" + myObj[property].rating +
                        "</td></tr>";
                }
            }
            content += "</table>"
            document.getElementById("stuff").innerHTML = content;
        }
    };
    xmlhttp.open("GET", "/genre", true);
    xmlhttp.send();

    //-------------- List All NavBar click to refresh list ---------------------
    $('#listAllNav').click(function(){
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                var myObj = JSON.parse(this.responseText);
                var content = "<table class=\"table table-striped\">";
                for (var property in myObj) {
                    if (myObj.hasOwnProperty(property)) {
                        content += "<tr><td>" + myObj[property].genreName + "</td><td>" + myObj[property].rating +
                            "</td></tr>";
                    }
                }
                content += "</table>"
                document.getElementById("stuff").innerHTML = content;
            }
        };
        xmlhttp.open("GET", "/genre", true);
        xmlhttp.send();
    });
    //--------------- get one Ajax ----------------------------------------------
    var xmlhttp2 = new XMLHttpRequest();
    document.getElementById('getByIdSubmit').onclick = xmlhttp2;

    $(document).ready(function(){
        $('#getByIdSubmit').click(function(){
            xmlhttp2.onreadystatechange = function() {

                if (this.readyState == 4 && this.status == 200) {
                    var myObj = JSON.parse(this.responseText);
                    var content = "<table class=\"table table-striped\">";
                    content += "<tr><td>" + myObj.genreName + "</td><td>" + myObj.rating +
                        "</td></tr>";
                    content += "</table>"
                    document.getElementById("DisplayGenre").innerHTML = content;
                }
            };
            xmlhttp2.open("GET", "/genre/"+$('#search').val(), true);
            xmlhttp2.send();
        });
    });

    //------------------------------ Add Genre AJAX ------------------------------------------
    $( "#addGenre" ).click(function() {
        var finishedMessage="{";
        var message = $( '#theGenre' ).serializeArray();
        $.each(message,function (i,field) {
            finishedMessage+="\"" + field.name + "\":\"" + field.value + "\",";
        });
        finishedMessage = finishedMessage.substring(0,finishedMessage.length - 1) + "}";
        var oReq = new XMLHttpRequest();
        oReq.open("POST", "/genre");
        oReq.setRequestHeader("Content-Type", "application/json");
        oReq.send(finishedMessage);
        console.log(finishedMessage);
    });
    //---------onclick update Navbar link ---------------
    $('#updateNav').click(function(){
        var ajaz = new XMLHttpRequest();
        ajaz.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                var myObj = JSON.parse(this.responseText);
                var content = "<select class=\"form-control\" id=\"selected4Update\">";
                for (var property in myObj) {
                    if (myObj.hasOwnProperty(property)) {
                        content += "<option value=\"" + myObj[property].genreName + "\">" + myObj[property].genreName +"</option>";
                    }
                }
                content += "</select>";
                document.getElementById("updateSelect").innerHTML = content;
            }
        };
        ajaz.open("GET", "/genre", true);
        ajaz.send();
    });
    //-------------------Update AJAX ---------------------------------------------------------
    $( "#updateGenreButton" ).on("click" ,function( event ) {
        var finishedMessage="{";
        var message = $( "#updateGenre" ).serializeArray();
        $.each(message,function (i,field) {
            finishedMessage+="\"" + field.name + "\":\"" + field.value + "\",";
        });
        finishedMessage =finishedMessage.substring(0,finishedMessage.length - 1) + "}";
        var oReq = new XMLHttpRequest();
        oReq.open("PUT", "/genre/"+ $( "#selected4Update" ).val());
        oReq.setRequestHeader("Content-Type", "application/json");
        oReq.send(finishedMessage);
        console.log(finishedMessage);
    });
    //---------------------Delete AJAX -----------------------------------------------------
    $( "#deleteTeam" ).on("click" ,function( event ) {
        var name = $( "#selected4Delete" ).val();
        var oReq = new XMLHttpRequest();
        oReq.open("DELETE", "/genre/"+ name);
        oReq.setRequestHeader("Content-Type", "application/json");
        oReq.send();
    });
    //---------onclick Delete Navbar link ---------------
    $('#deleteNav').click(function(){
        $('#deleteResult').html('');
        $('#dTeam').show();
        var ajaz = new XMLHttpRequest();
        ajaz.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                var myObj = JSON.parse(this.responseText);
                var content = "<select class=\"form-control\" id=\"selected4Delete\">";
                for (var property in myObj) {
                    if (myObj.hasOwnProperty(property)) {
                        content += "<option value=\"" + myObj[property].genreName + "\">" + myObj[property].genreName +"</option>";
                    }
                }
                content += "</select>";
                document.getElementById("deleteSelect").innerHTML = content;
            }
        };
        ajaz.open("GET", "/genre", true);
        ajaz.send();
    });
//---------------Delete genre button click -----------------------
    $('#deleteTeam').click(function(){
        $('#dTeam').hide();
        $('#deleteResult').html('Your Genre has been deleted.');
    });

</script>
</body>
</html>